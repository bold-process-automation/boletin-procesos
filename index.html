
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bolet√≠n de Procesos | Bold</title>
  <link rel="icon" type="image/x-icon" href="favicon-bold.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%23121f6c'/><text x='16' y='22' text-anchor='middle' fill='white' font-family='Arial, sans-serif' font-weight='bold' font-size='14'>B</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bold-primary: #121f6c;     /* Azul principal Bold */
      --bold-secondary: #4d2864;   /* Morado corporativo */
      --bold-accent: #692e60;      /* Morado medio */
      --bold-coral: #9c3559;       /* Coral corporativo */
      --bold-red: #bf3b51;         /* Rojo Bold */
      --bold-bright: #ee424e;      /* Rojo vibrante */
      --bold-success: #22c55e;     /* Verde √©xito */
      --bold-warning: #f59e0b;     /* Amarillo advertencia */
      --bold-error: #891618;       /* Granate error */
      --bold-gradient-primary: linear-gradient(135deg, #121f6c 0%, #4d2864 100%);
      --bold-gradient-accent: linear-gradient(135deg, #692e60 0%, #9c3559 100%);
      --bold-text-dark: #1f2937;
      --bold-text-light: #6b7280;
      --bold-bg-light: #f8fafc;
    }
    
    * { font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, sans-serif; }
    html { scroll-behavior: smooth; }
    body { 
      background: var(--bold-bg-light);
      color: var(--bold-text-dark);
      line-height: 1.6;
    }
    
    .fade-in{animation:fade .4s ease-out both}
    @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .bar{transition:width .4s ease}
    
    /* Navegaci√≥n profesional */
    .nav-btn{
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
      font-weight: 500;
      font-size: 0.95rem;
      letter-spacing: -0.025em;
    }
    .nav-btn:hover{
      background: var(--bold-gradient-primary) !important; 
      color: white !important; 
      transform: translateY(-1px); 
      box-shadow: 0 6px 20px rgba(18, 31, 108, 0.25);
      border-color: transparent !important;
    }
    .nav-btn:active{transform:translateY(0px);}
    
    /* Clases de colores */
    .bold-gradient-primary { background: var(--bold-gradient-primary); }
    .bold-gradient-accent { background: var(--bold-gradient-accent); }
    .bold-primary { color: var(--bold-primary); }
    .bold-secondary { color: var(--bold-secondary); }
    .bold-accent { color: var(--bold-accent); }
    .bold-coral { color: var(--bold-coral); }
    .bold-red { color: var(--bold-red); }
    .bold-bright { color: var(--bold-bright); }
    .bold-success { color: var(--bold-success); }
    .bold-warning { color: var(--bold-warning); }
    .bold-error { color: var(--bold-error); }
    
    /* Header de tabla profesional */
    th.sticky{
      position:sticky;
      top:0;
      background: var(--bold-primary);
      color:#fff; 
      font-weight: 600;
      font-size: 0.875rem;
      letter-spacing: 0.025em;
      text-transform: uppercase;
    }
    
    /* Tarjetas corporativas */
    .card-shadow { 
      box-shadow: 0 2px 8px rgba(18, 31, 108, 0.08), 0 0 1px rgba(18, 31, 108, 0.12); 
      border: 1px solid rgba(18, 31, 108, 0.06);
    }
    .card-shadow:hover { 
      box-shadow: 0 8px 32px rgba(18, 31, 108, 0.16), 0 2px 8px rgba(18, 31, 108, 0.08); 
      transform: translateY(-2px); 
      border-color: rgba(18, 31, 108, 0.12);
    }
    
    /* Bot√≥n principal corporativo */
    .bold-button {
      background: var(--bold-gradient-accent);
      color: white;
      font-weight: 600;
      border-radius: 10px;
      padding: 12px 24px;
      border: none;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 0.9rem;
      letter-spacing: -0.025em;
    }
    .bold-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(156, 53, 89, 0.3);
      filter: brightness(1.05);
    }
    
    /* Tipograf√≠a profesional */
    .heading-primary {
      font-weight: 800;
      letter-spacing: -0.03em;
      line-height: 1.1;
    }
    .heading-secondary {
      font-weight: 700;
      letter-spacing: -0.025em;
      line-height: 1.2;
    }
    .text-corporate {
      font-weight: 500;
      color: var(--bold-text-light);
      line-height: 1.6;
    }
    
    /* Utilidades para tarjetas estilo Bold.co */
    .line-clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    /* Animaciones para botones del hero */
    .hero-nav-btn {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform, box-shadow;
    }
    
    /* Navegaci√≥n sticky con animaci√≥n suave */
    .sticky-nav-btn {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform, box-shadow;
    }
    
    /* Mejoras de smooth scroll */
    html {
      scroll-padding-top: 100px;
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Hero Section estilo Bold.co -->
  <div class="relative min-h-screen overflow-hidden">
    <!-- Fondo con imagen corporativa -->
    <div class="absolute inset-0" style="background-image: url('header-bold.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat;"></div>
    <!-- Overlay opcional para mejorar legibilidad del texto -->
    <div class="absolute inset-0 bg-black/10"></div>
    <!-- Header actualizado con design system Bold -->
    
    <!-- Contenido principal -->
    <div class="relative flex items-center min-h-screen">
      <div class="w-full px-8 md:px-16 py-20">
        <div class="flex items-center justify-between min-h-[70vh] px-4">
          <!-- Columna izquierda: Contenido (centrado en las l√≠neas izquierdas) -->
          <div class="w-1/2 pl-4 lg:pl-8 space-y-8 text-left flex flex-col justify-center">
            <!-- Etiqueta superior -->
            <div class="mb-8">
              <span class="text-white text-xl font-semibold tracking-wide uppercase">Arquitectura de Negocio y Automatizaci√≥n</span>
            </div>
            
            <!-- T√≠tulo principal -->
            <div class="space-y-8">
              <h1 class="text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-black leading-tight text-white">
                Bolet√≠n de Procesos
              </h1>
              
              <p class="text-xl md:text-2xl leading-relaxed text-white/90 max-w-xl">
                Informaci√≥n actualizada sobre cambios, automatizaciones y mejoras continuas en Bold CF y Bold.co SAS
              </p>
            </div>
          </div>
          
          <!-- Columna derecha: Botones (centrados en las l√≠neas derechas) -->
          <div class="w-1/2 flex justify-center items-center pr-4 lg:pr-8">
            <div id="heroNavButtons" class="flex flex-col gap-5 w-full max-w-sm">
              <a href="#cambios" class="hero-nav-btn group bg-white hover:bg-gray-50 rounded-full px-10 py-5 font-bold text-xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 w-full">
                <div class="flex items-center justify-center gap-4">
                  <div class="w-10 h-10 bg-[#FF2947]/10 rounded-full flex items-center justify-center group-hover:bg-[#FF2947]/20 transition-colors">
                    <svg class="w-5 h-5 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 01-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z" clip-rule="evenodd"/>
                    </svg>
                  </div>
                  <span class="text-[#FF2947]">Procesos</span>
                </div>
              </a>
              
              <a href="#valor-agregado" class="hero-nav-btn group bg-white hover:bg-gray-50 rounded-full px-10 py-5 font-bold text-xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 w-full">
                <div class="flex items-center justify-center gap-4">
                  <div class="w-10 h-10 bg-[#FF2947]/10 rounded-full flex items-center justify-center group-hover:bg-[#FF2947]/20 transition-colors">
                    <svg class="w-5 h-5 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"/><path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"/>
                    </svg>
                  </div>
                  <span class="text-[#FF2947]">Valor Agregado</span>
                </div>
              </a>
              
              <a href="#automatizaciones" class="hero-nav-btn group bg-white hover:bg-gray-50 rounded-full px-10 py-5 font-bold text-xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 w-full">
                <div class="flex items-center justify-center gap-4">
                  <div class="w-10 h-10 bg-[#FF2947]/10 rounded-full flex items-center justify-center group-hover:bg-[#FF2947]/20 transition-colors">
                    <svg class="w-5 h-5 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"/>
                    </svg>
                  </div>
                  <span class="text-[#FF2947]">Automatizaciones</span>
                </div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Navegaci√≥n sticky (se transforma desde los botones del hero) -->
  <nav id="stickyNav" class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-xl py-4 z-50 border-b border-gray-200/50 shadow-lg transition-all duration-500 translate-y-[-100%] opacity-0">
    <div class="mx-auto max-w-4xl px-6">
      <div class="flex justify-center gap-3">
        <a href="#cambios" class="sticky-nav-btn bg-white hover:bg-gray-50 border-2 border-gray-200 rounded-full px-6 py-3 text-sm font-bold transition-all duration-300 hover:shadow-lg hover:scale-105">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 01-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z" clip-rule="evenodd"/>
            </svg>
            <span class="hidden sm:inline text-[#FF2947]">Procesos</span>
          </span>
        </a>
        
        <a href="#valor-agregado" class="sticky-nav-btn bg-white hover:bg-gray-50 border-2 border-gray-200 rounded-full px-6 py-3 text-sm font-bold transition-all duration-300 hover:shadow-lg hover:scale-105">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
              <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"/><path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"/>
            </svg>
            <span class="hidden sm:inline text-[#FF2947]">Valor Agregado</span>
          </span>
        </a>
        
        <a href="#automatizaciones" class="sticky-nav-btn bg-white hover:bg-gray-50 border-2 border-gray-200 rounded-full px-6 py-3 text-sm font-bold transition-all duration-300 hover:shadow-lg hover:scale-105">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4 text-[#FF2947]" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"/>
            </svg>
            <span class="hidden sm:inline text-[#FF2947]">Automatizaciones</span>
          </span>
        </a>
      </div>
    </div>
  </nav>
  
  <div class="mx-auto max-w-7xl p-6 md:p-12">


    <!-- ========== CAMBIOS (LISTADO) ========== -->
    <section id="cambios" class="mt-24 scroll-mt-32">
      <!-- Header estilo consistente con las otras secciones -->
      <div class="text-center mb-16">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl md:text-5xl lg:text-6xl font-black leading-none mb-8">
            <span class="bg-gradient-to-r from-[#121f6c] via-[#4d2864] to-[#692e60] bg-clip-text text-transparent">
              Cambios de
            </span>
            <span class="text-gray-900 ml-4">
              Procesos
            </span>
          </h2>
          
          <p class="text-lg md:text-xl max-w-3xl mx-auto leading-relaxed mb-8" style="color: #121f6c;">
            Registro y seguimiento detallado de creaciones, actualizaciones y modificaciones en los procesos organizacionales de Bold CF y Bold.co SAS.
          </p>
        </div>
      </div>
      <!-- Controles mejorados estilo Bold.co -->
      <div class="bg-white rounded-2xl card-shadow p-6 mb-8">
        <!-- B√∫squeda principal -->
        <div class="flex items-center gap-4">
          <div class="flex-1 relative">
            <input id="q2" type="text" placeholder="Buscar procesos, documentos, responsables..." class="pl-12 w-full rounded-2xl border border-gray-200 h-12 px-6 text-base outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 card-shadow" />
            <svg class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <button id="resetBtn2" class="bold-button px-6 py-3 whitespace-nowrap">
            ‚Üª Limpiar filtros
          </button>
        </div>
      </div>
      
      <!-- Paginaci√≥n y contador arriba de la tabla -->
      <div class="flex items-center justify-between mt-4 mb-2 text-xs text-slate-600">
        <div id="countCambios">0 resultados</div>
        <div class="flex gap-2">
          <button id="prevPage" class="rounded-md border px-2 py-1 bg-white border-slate-300 hover:bg-slate-50">¬´</button>
          <span id="pageInfo" class="px-1">1 / 1</span>
          <button id="nextPage" class="rounded-md border px-2 py-1 bg-white border-slate-300 hover:bg-slate-50">¬ª</button>
        </div>
      </div>
      
      <div class="overflow-x-auto border border-slate-200 rounded-2xl">
        <table class="w-full text-sm">
          <thead>
            <tr class="bg-slate-900">
              <th class="sticky px-3 py-2 text-left w-32">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">C√≥digo</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="codigo" onclick="showFilterDropdown('codigo', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Documento</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="documento" onclick="showFilterDropdown('documento', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left w-48">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Due√±o</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="dueno" onclick="showFilterDropdown('dueno', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Detalle</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="detalle" onclick="showFilterDropdown('detalle', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left w-20">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Compa√±√≠a</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="compania" onclick="showFilterDropdown('compania', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left w-24">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Tipo</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="tipo" onclick="showFilterDropdown('tipo', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left w-28">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">Fecha</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="fecha" onclick="showFilterDropdown('fecha', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
              <th class="sticky px-3 py-2 text-left w-20">
                <div class="flex items-center justify-between">
                  <span class="text-white text-sm font-medium">VA</span>
                  <button class="filter-btn text-white/70 hover:text-white" data-column="va" onclick="showFilterDropdown('va', event)">
                    <svg class="w-3 h-3" viewBox="0 0 12 12" fill="currentColor">
                      <path d="M0 0h12l-5 6v4l-2 2v-6l-5-6z"/>
                    </svg>
                  </button>
                </div>
              </th>
            </tr>
          </thead>
          <tbody id="tbodyCambios" class="bg-white"></tbody>
        </table>
      </div>
      
      <!-- Dropdown de filtro estilo Google Sheets -->
      <div id="filterDropdown" class="hidden fixed bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-64">
        <div class="p-3">
          <!-- Opciones de ordenamiento -->
          <div class="border-b pb-2 mb-2">
            <button onclick="applySortFilter('asc')" class="w-full text-left px-2 py-1 hover:bg-gray-100 rounded text-sm flex items-center gap-2">
              <span>‚Üë</span> Ordenar A ‚Üí Z
            </button>
            <button onclick="applySortFilter('desc')" class="w-full text-left px-2 py-1 hover:bg-gray-100 rounded text-sm flex items-center gap-2">
              <span>‚Üì</span> Ordenar Z ‚Üí A
            </button>
          </div>
          
          <!-- Filtros -->
          <div class="mb-2">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium">Filtrar por:</span>
              <button onclick="clearColumnFilter()" class="text-xs text-blue-600 hover:text-blue-800">Limpiar</button>
            </div>
            
            <!-- Buscar dentro de la columna -->
            <div class="mb-2">
              <input id="columnSearch" type="text" placeholder="Buscar..." class="w-full text-xs border border-gray-300 rounded px-2 py-1">
            </div>
            
            <!-- Checkboxes de selecci√≥n -->
            <div class="max-h-48 overflow-y-auto">
              <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 text-sm">
                <input type="checkbox" id="selectAll" onchange="toggleAllFilters()" checked>
                <span class="font-medium">(Seleccionar todo)</span>
              </label>
              <div id="filterOptions" class="border-t pt-1 mt-1">
                <!-- Opciones din√°micas se cargar√°n aqu√≠ -->
              </div>
            </div>
          </div>
          
          <!-- Botones de acci√≥n -->
          <div class="flex gap-2 pt-2 border-t">
            <button onclick="applyColumnFilter()" class="flex-1 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">OK</button>
            <button onclick="hideFilterDropdown()" class="flex-1 bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-300">Cancelar</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== VALOR AGREGADO POR UNIDAD DE NEGOCIO ========== -->
    <section id="valor-agregado" class="mt-24 scroll-mt-32">
      <!-- Secci√≥n expandida a ancho completo -->
      <div class="w-full">
        <!-- T√≠tulo centrado y grande -->
        <div class="text-center mb-16">
          <div class="max-w-6xl mx-auto">
            <h2 class="text-5xl md:text-6xl lg:text-7xl font-black leading-none mb-8">
              <span class="bg-gradient-to-r from-[#121f6c] via-[#4d2864] via-[#692e60] via-[#9c3559] to-[#bf3b51] bg-clip-text text-transparent">
                Valor agregado por unidad de negocio
              </span>
            </h2>
            <p class="text-lg md:text-xl leading-relaxed max-w-4xl mx-auto" style="color: #121f6c;">
              Visualiza el impacto y rendimiento detallado de cada unidad organizacional con datos actualizados y m√©tricas clave.
            </p>
          </div>
        </div>
        
        <!-- Grid de tarjetas expandido -->
        <div class="max-w-7xl mx-auto px-6 md:px-12">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
            <!-- Tarjeta SAS -->
            <div class="bg-white rounded-3xl card-shadow overflow-hidden hover:shadow-xl transition-all duration-300 h-[450px]">
              <!-- Header estilo Bold.co -->
              <div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-md">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="url(#gradient1)"/>
                      <path d="M2 17L12 22L22 17" stroke="url(#gradient1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M2 12L12 17L22 12" stroke="url(#gradient1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <defs>
                        <linearGradient id="gradient1" x1="2" y1="2" x2="22" y2="22" gradientUnits="userSpaceOnUse">
                          <stop stop-color="#3B82F6"/>
                          <stop offset="1" stop-color="#6366F1"/>
                        </linearGradient>
                      </defs>
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-2xl font-bold text-gray-900">Bold.co SAS</h3>
                    <p class="text-gray-600 text-base">Valor agregado por proceso</p>
                  </div>
                </div>
              </div>
              
              <!-- Contenido del gr√°fico -->
              <div class="p-6 flex-1">
                <div class="bg-gradient-to-br from-gray-50 to-white p-4 rounded-2xl border border-gray-100 h-full shadow-inner">
                  <img id="img1" alt="Valor agregado SAS" class="w-full h-full object-contain rounded-xl cursor-zoom-in hover:scale-[1.02] transition-transform duration-300">
                </div>
              </div>
            </div>
            
            <!-- Tarjeta CF -->
            <div class="bg-white rounded-3xl card-shadow overflow-hidden hover:shadow-xl transition-all duration-300 h-[450px]">
              <!-- Header estilo Bold.co -->
              <div class="bg-gradient-to-br from-purple-50 to-pink-100 p-6">
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-md">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="3" width="18" height="18" rx="4" fill="url(#gradient2)"/>
                      <path d="M8 12H16M12 8V16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                      <circle cx="12" cy="12" r="2" fill="white"/>
                      <defs>
                        <linearGradient id="gradient2" x1="3" y1="3" x2="21" y2="21" gradientUnits="userSpaceOnUse">
                          <stop stop-color="#A855F7"/>
                          <stop offset="1" stop-color="#EC4899"/>
                        </linearGradient>
                      </defs>
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-2xl font-bold text-gray-900">Bold CF</h3>
                    <p class="text-gray-600 text-base">Valor agregado por proceso</p>
                  </div>
                </div>
              </div>
              
              <!-- Contenido del gr√°fico -->
              <div class="p-6 flex-1">
                <div class="bg-gradient-to-br from-gray-50 to-white p-4 rounded-2xl border border-gray-100 h-full shadow-inner">
                  <img id="img2" alt="Valor agregado CF" class="w-full h-full object-contain rounded-xl cursor-zoom-in hover:scale-[1.02] transition-transform duration-300">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal/lightbox para ampliar -->
      <div id="lightbox" class="fixed inset-0 bg-black/70 hidden items-center justify-center p-4 z-50">
        <img id="lightboxImg" class="max-h-[90vh] max-w-[95vw] rounded-xl shadow-2xl">
      </div>
    </section>

    <!-- ========== AUTOMATIZACIONES (TARJETAS) ========== -->
    <section id="automatizaciones" class="mt-24 scroll-mt-32">
      <!-- Header estilo de las im√°genes con tipograf√≠a moderna -->
      <div class="text-center mb-16">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl md:text-5xl lg:text-6xl font-black leading-none mb-8">
            <span class="bg-gradient-to-r from-[#121f6c] via-[#4d2864] to-[#692e60] bg-clip-text text-transparent">
              Automatizaciones
            </span>
            <span class="text-gray-900 ml-4">
              Implementadas
            </span>
          </h2>
          
          <p class="text-lg md:text-xl max-w-3xl mx-auto leading-relaxed mb-8" style="color: #121f6c;">
            Seguimiento del progreso y valor agregado de las automatizaciones en producci√≥n. 
            Cada tarjeta muestra el estado actual, impacto y detalles de implementaci√≥n.
          </p>
        </div>
      </div>
      
      <!-- Controles mejorados estilo Bold.co -->
      <div class="bg-white rounded-2xl card-shadow p-6 mb-8">
        <!-- B√∫squeda principal -->
        <div class="mb-6">
          <div class="relative">
            <input id="q" type="text" placeholder="Buscar por aplicaci√≥n, proceso o compa√±√≠a..." class="pl-12 w-full rounded-2xl border border-gray-200 h-14 px-6 text-lg outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 card-shadow" />
            <svg class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
        </div>
        
        <!-- Filtros y controles -->
        <div class="flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between">
          <!-- Filtros de compa√±√≠a -->
          <div class="flex flex-wrap gap-3 items-center">
            <span class="text-sm font-semibold text-gray-700">Compa√±√≠a:</span>
            <button data-company="" class="company-btn bg-gray-50 border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 rounded-full px-4 py-2 text-sm font-medium transition-all">
              Todas
            </button>
            <span id="companyBadges" class="flex flex-wrap gap-2"></span>
          </div>
          
          <!-- Botones de control -->
          <div class="flex gap-3">
            <button id="sortBtn" class="rounded-xl border-2 border-gray-200 px-6 py-3 text-sm font-medium bg-white hover:bg-gray-50 hover:border-gray-300 transition-all card-shadow">
              üìà Ordenar por % VA
            </button>
            <button id="resetBtn" class="bold-button px-6 py-3">
              ‚Üª Limpiar filtros
            </button>
          </div>
        </div>
      </div>
      
      <!-- Grid de tarjetas -->
      <div id="cards" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
    </section>

  </div>
  
  <!-- Bot√≥n flotante volver arriba (visible solo en scroll) -->
  <button id="scrollToTopFloat" onclick="scrollToTop()" class="fixed bottom-8 right-8 bg-gradient-to-r from-[#121f6c] to-[#4d2864] text-white w-14 h-14 rounded-full shadow-2xl hover:scale-110 transition-all duration-300 z-50 opacity-0 pointer-events-none">
    <svg class="w-6 h-6 mx-auto" fill="currentColor" viewBox="0 0 20 20">
      <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
    </svg>
  </button>

<script>
  function parseLocalDate(ymd){ const p=String(ymd||'').split('-').map(Number); return new Date(p[0]||1970,(p[1]||1)-1,p[2]||1); }
  function formatDate(ymd){ const d=parseLocalDate(ymd); return d.toLocaleDateString('es-CO',{day:'2-digit',month:'2-digit',year:'2-digit'}); }

  // Mapeo de enlaces de Coda por nombre de documento
  const documentLinks = {
    "Gesti√≥n de transferencias ACH": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/OP-PR-022-Gestion-de-transferencias-ACH_suemVnbM?search=Gesti%C3%B3n%20de%20transferencias%20ACH#Copy-of-Copy-of-Cabezote-122-44_tutlTec9",
    "Instructivo Actualizaci√≥n Fuente de Adquirencia": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/OP-IN-030-05-Instructivo-Actualizacion-Fuente-de-Adquirencia_sue8-tzy?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20Actualizaci%C3%B3n%20Fuente%20de%20Adquirencia",
    "Instructivo Pago y liquidaci√≥n de Bold CF a Bold CO SAS": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/OP-IN-030-06-Instructivo-Pago-y-liquidacion-de-Bold-CF-a-Bold-CO_suhVYdYL?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20Pago%20y%20liquidaci%C3%B3n%20de%20Bold%20CF%20a%20Bold%20CO%20SAS",
    "Ajustes de adquirencia": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/OP-PR-033-Ajustes-de-adquirencia_sumfIGaP?docIds%5B0%5D=PZrHIIUQg-&search=Ajustes%20de%20adquirencia",
    "Comunicaciones a clientes": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/GM-PR-001-Comunicaciones-a-clientes_su45TOKR?docIds%5B0%5D=PZrHIIUQg-&search=Comunicaciones%20a%20clientes",
    "Reclutamiento de personal": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/TH-PR-001-Reclutamiento-de-personal_sudeRr7W?docIds%5B0%5D=PZrHIIUQg-&search=Reclutamiento%20de%20personal",
    "Offboarding de personal": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/TH-PR-008-Offboarding-de-personal_suz77-BW?docIds%5B0%5D=PZrHIIUQg-&search=Offboarding%20de%20personal",
    "Gesti√≥n programa ESOP": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/TH-PR-011-Gestion-programa-ESOP_suF9E_l6?docIds%5B0%5D=PZrHIIUQg-&search=Gesti%C3%B3n%20programa%20ESOP",
    "Liquidaci√≥n y pago de aportes": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/TH-PR-012-Liquidacion-y-pago-de-aportes_su2dN3VF?docIds%5B0%5D=PZrHIIUQg-&search=Liquidaci%C3%B3n%20y%20pago%20de%20aportes",
    "Cambio interno de rol": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/TH-PR-024-Cambio-interno-de-rol_suF6NXPO?docIds%5B0%5D=PZrHIIUQg-&search=Cambio%20interno%20de%20rol",
    "Instructivo Generaci√≥n Informe IRL": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/GF-IN-005-02-Instructivo-Generacion-Informe-IRL_suS5GFdM?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20Generaci%C3%B3n%20Informe%20IRL",
    "Instructivo Generaci√≥n Informe CFEN": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/GF-IN-005-03-Instructivo-Generacion-Informe-CFEN_suXq5J0X?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20Generaci%C3%B3n%20Informe%20CFEN",
    "Instructivo conciliaci√≥n cobro y recaudo tarjeta de cr√©dito": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/GF-IN-030-01-Instructivo-conciliacion-cobro-y-recaudo-tarjeta-de_su_lHZig?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20conciliaci%C3%B3n%20cobro%20y%20recaudo%20tarjeta%20de%20cr%C3%A9dito",
    "Instructivo control y seguimiento de cupos": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/GF-IN-030-02-Instructivo-control-y-seguimiento-de-cupos_su6SvZ8v?docIds%5B0%5D=PZrHIIUQg-&search=Instructivo%20control%20y%20seguimiento%20de%20cupos",
    "Gesti√≥n de Compras": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/SI-PR-004-Gestion-de-compras_suHNoYhL?docIds%5B0%5D=PZrHIIUQg-&search=Gesti%C3%B3n%20de%20Compras",
    "Selecci√≥n y creaci√≥n de terceros": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/SI-PR-006-Seleccion-y-creacion-de-terceros_supPV5mn?docIds%5B0%5D=PZrHIIUQg-&search=Selecci%C3%B3n%20y%20creaci%C3%B3n%20de%20terceros",
    "Recolecci√≥n de activos fijos e implementos de trabajo en offboarding": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/SI-PR-008-Recoleccion-de-activos-fijos-e-implementos-de-trabajo-_suLlHh3z?docIds%5B0%5D=PZrHIIUQg-&search=Recolecci%C3%B3n%20de%20activos%20fijos%20e%20implementos%20de%20trabajo%20en%20offboarding",
    "Manual Ejecuci√≥n Debida Diligencia Intensificada (DDI) CF": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/LC-MA-006-Manual-Ejecucion-Debida-Diligencia-Intensificada-DDI-C_suPEwkd7?docIds%5B0%5D=PZrHIIUQg-&search=Manual%20Ejecuci%C3%B3n%20Debida%20Diligencia%20Intensificada%20%28DDI%29%20CF",
    "Manual Metodol√≥gico Matriz de Riesgos SARLAFT": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/LC-MA-007-Manual-Metodologico-Matriz-de-Riesgos-SARLAFT_suzr4F8x?docIds%5B0%5D=PZrHIIUQg-&search=Manual%20Metodol%C3%B3gico%20Matriz%20de%20Riesgos%20SARLAFT",
    "Manual Metodolog√≠a Segmentaci√≥n de Riesgo Clientes": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/LC-MA-009-Manual-Metodologia-Segmentacion-de-Riesgo-Clientes_suWtffT_?docIds%5B0%5D=PZrHIIUQg-&search=Manual%20Metodolog%C3%ADa%20Segmentaci%C3%B3n%20de%20Riesgo%20Clientes",
    "Pol√≠tica activos fijos y elementos de trabajo": "https://coda.io/d/Arquitectura-de-Procesos_dPZrHIIUQg-/SI-PO-002-Politica-activos-fijos-y-elementos-de-trabajo_suY6mGAt?docIds%5B0%5D=PZrHIIUQg-&search=Pol%C3%ADtica%20activos%20fijos%20y%20elementos%20de%20trabajo",
    "Cierre diario de turno para clientes master merchant SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/OP-PR-169-Cierre-diario-de-turno-para-clientes-master-merchant-S_suOTZYVu?docIds%5B0%5D=ywYtLrlDx7&search=Cierre%20diario%20de%20turno%20para%20clientes%20master%20merchant%20SAS",
    "Comunicaciones a clientes SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/GM-PR-101-Comunicaciones-a-clientes-SAS_suO2I39n?docIds%5B0%5D=ywYtLrlDx7&search=Comunicaciones%20a%20clientes%20SAS",
    "Cambio interno de rol SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/TH-PR-124-Cambio-interno-de-rol_suz20-ca?docIds%5B0%5D=ywYtLrlDx7&search=Cambio%20interno%20de%20rol%20SAS",
    "Recolecci√≥n de activos fijos e implementos de trabajo en offboarding SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/SI-PR-108-Recoleccion-de-activos-fijos-e-implementos-de-trabajo-_suRvgjLv?docIds%5B0%5D=ywYtLrlDx7&search=Recolecci%C3%B3n%20de%20activos%20fijos%20e%20implementos%20de%20trabajo%20en%20offboarding%20SAS",
    "Manual Ejecuci√≥n Debida Diligencia Intensificada (DDI) SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/LC-MA-106-Manual-Ejecucion-Debida-Diligencia-Intensificada-DDI-S_suqy4vIX?docIds%5B0%5D=ywYtLrlDx7&search=Manual%20Ejecuci%C3%B3n%20Debida%20Diligencia%20Intensificada%20%28DDI%29%20SAS",
    "Documento Metodol√≥gico Matriz de Riesgos SAGRILAFT SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/LC-MA-107-Metodologico-Matriz-de-Riesgos-SAGRILAFT-SAS_suZRhaG_?docIds%5B0%5D=ywYtLrlDx7&search=Documento%20Metodol%C3%B3gico%20Matriz%20de%20Riesgos%20SAGRILAFT%20SAS",
    "Documento Metodol√≥gico Matriz de Riesgos PTEE (C/ST) - Programa de Transparencia y √âtica Empresarial SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/LC-MA-108-Documento-Metodologico-Matriz-de-Riesgos-PTEE-C-ST-Pro_su6fWroN?docIds%5B0%5D=ywYtLrlDx7&search=Documento%20Metodol%C3%B3gico%20Matriz%20de%20Riesgos%20PTEE%20%28C%2FST%29%20-%20Programa%20de%20Transparencia%20y%20%C3%89tica%20Empresarial%20SAS",
    "Manual Metodolog√≠a Segmentaci√≥n de Riesgo Clientes SAS": "https://coda.io/d/Arquitectura-de-Procesos-Bold-co-SAS_dywYtLrlDx7/LC-MA-109-Manual-Metodologia-Segmentacion-de-Riesgo-Clientes-SAS_suIAroNe?docIds%5B0%5D=ywYtLrlDx7&search=Manual%20Metodolog%C3%ADa%20Segmentaci%C3%B3n%20de%20Riesgo%20Clientes%20SAS"
  };
  
  let rows = [{"aplicativo": "APPIAN", "aplicacion": "RPA Ciclo operativo ACH", "proceso": "OP-PR-022 Gesti√≥n de transferencias ACH", "detalle": "Cargue y descarga de transacciones en integra ACH y neurona para su posterior conciliaci√≥n ", "compania": "CF", "vaFinal": 70.0, "incrementoVA": 38.0, "fecha": "2025-08-06"}, {"aplicativo": "APPIAN", "aplicacion": "Gesti√≥n de planes de acci√≥n de RO", "proceso": "GR-PR-005 Elaboraci√≥n y Seguimiento a Planes de Acci√≥n de RO\nGR-PR-105 Elaboraci√≥n y Seguimiento a Planes de Acci√≥n de RO SAS", "detalle": "Creaci√≥n (Risk Manager) y seguimiento (responsables) a los planes de acci√≥n de RO", "compania": "SAS Y CF", "vaFinal": 100.0, "incrementoVA": 33.0, "fecha": "2025-08-05"}, {"aplicativo": "APPIAN", "aplicacion": "Gesti√≥n de eventos RO", "proceso": "GR-PR-006 Gesti√≥n de eventos de riesgo operacional\nGR-PR-106 Gesti√≥n de eventos de riesgo operacional SAS", "detalle": NaN, "compania": "SAS Y CF", "vaFinal": 80.0, "incrementoVA": 5.0, "fecha": "2025-08-05"}];
  const cambios = [{"codigo": "OP-PR-022", "documento": "Gesti√≥n de transferencias ACH", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Inclusi√≥n de RPA Appian en las actividades que realizaba el Analista de Operaciones Financieras (Back) Bold.co SAS\nInclusi√≥n como output del proceso, el proceso OP-PR-036 Contabilizaci√≥n y conciliaci√≥n de Cash In y Cash Out", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-19", "valor_agregado": "70.45%"}, {"codigo": "OP-IN-030-05", "documento": "Instructivo Actualizaci√≥n Fuente de Adquirencia", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Su objetivo es asegurar la adecuada actualizaci√≥n de la base de datos del √°rea de adquirencia mediante la inclusi√≥n de informaci√≥n consolidada, completa y precisa, en relaci√≥n con el origen de los datos y las fechas establecidas en cada uno de los archivos consolidados. Esto con el fin de reflejar los resultados obtenidos a nivel operativo y mostrarlos al √°rea de FinOps, generando valor a trav√©s de la visualizaci√≥n de datos.", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-27", "valor_agregado": "N/A"}, {"codigo": "OP-IN-030-06", "documento": "Instructivo Pago y liquidaci√≥n de Bold CF a Bold CO SAS", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Su objetivo es validar correctamente el pago a BOLD CO SAS de los montos resultantes del cuadre operativo y la conciliaci√≥n de las franquicias para todos los tipos de procesamiento (dom√©stico e internacional), asegurando que las transacciones procesadas sean liquidadas por Bold CF a Bold CO SAS, a trav√©s de la liquidaci√≥n de Payouts, el traslado entre cuentas y la generaci√≥n de un informe al √°rea de tesorer√≠a respecto a la operaci√≥n.", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-27", "valor_agregado": "N/A"}, {"codigo": "OP-PR-033", "documento": "Ajustes de adquirencia", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Inclusi√≥n de Appian\nAjuste general del proceso", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-04", "valor_agregado": "66.67%"}, {"codigo": "GM-PR-001", "documento": "Comunicaciones a clientes", "dueno": "Mar√≠a Paula Machado Pantoja", "detalle": "Se a√±ade actividad 21. \"Notificar los resultados de la campa√±a\"", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-20", "valor_agregado": "77.27%"}, {"codigo": "TH-PR-001", "documento": "Reclutamiento de personal", "dueno": "Lina Meza", "detalle": "Eliminaci√≥n de actividades correspondientes a convocatoria interna ya que est√°n dentro del proceso TH-PR-024 Cambio interno de rol\nAclaraci√≥n de actividades de prueba de pol√≠grafo para las distintas √°reas\nInclusi√≥n de actividades relacionadas al c√°lculo de acciones con Appian", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "43.33%"}, {"codigo": "TH-PR-008", "documento": "Offboarding de personal", "dueno": "Lina Meza", "detalle": "Se eliminan las actividades correspondientes al rol Inventory Analyst\nAjuste general del flujo", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "42.11%"}, {"codigo": "TH-PR-011", "documento": "Gesti√≥n programa ESOP", "dueno": "Lina Meza", "detalle": "Eliminaci√≥n de Carta como gestor de plan de acciones, ahora todo se visualiza en BambooHR y se gestionan con un m√≥dulo de Appian.\nCambio del nombre del proceso.", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "93.10%"}, {"codigo": "TH-PR-012", "documento": "Liquidaci√≥n y pago de aportes", "dueno": "Lina Meza", "detalle": "Adici√≥n de la actividad 6. \"Conciliar planilla vs. Contabilidad\"", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "45.45%"}, {"codigo": "TH-PR-024", "documento": "Cambio interno de rol", "dueno": "Lina Meza", "detalle": "Ajuste del proceso", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-12", "valor_agregado": "45.16%"}, {"codigo": "GF-IN-005-02", "documento": "Instructivo Generaci√≥n Informe IRL", "dueno": "Nicoll Albornoz Blanco", "detalle": "Inclusi√≥n de actividades de el Analista de Operaciones Financieras Senior Bold.co SAS relacionadas a la validaci√≥n de la reporter√≠a de microcr√©dito tarjeta\nInclusi√≥n de actividades de el Analista de Operaciones Financieras Bold.co SAS relacionadas a la validaci√≥n de la reporter√≠a de emisi√≥n\nAjuste de las actividades del responsable del reporte", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-19", "valor_agregado": "N/A"}, {"codigo": "GF-IN-005-03", "documento": "Instructivo Generaci√≥n Informe CFEN", "dueno": "Nicoll Albornoz Blanco", "detalle": "Ajuste de las actividades del responsable del reporte", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-19", "valor_agregado": "N/A"}, {"codigo": "GF-IN-030-01", "documento": "Instructivo conciliaci√≥n cobro y recaudo tarjeta de cr√©dito", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Su objetivo es conciliar los pagos realizados por los clientes de microcr√©dito tarjeta a trav√©s de los medios habilitados contra los registros internos y contables.", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-19", "valor_agregado": "N/A"}, {"codigo": "GF-IN-030-02", "documento": "Instructivo control y seguimiento de cupos", "dueno": "Cesar Miguel Izaguirre Sanchez", "detalle": "Su objetivo es conciliar y validar la consistencia de los cupos de microcr√©dito tarjeta (aprobado, utilizado y disponible) entre los reportes, identificando y gestionando las diferencias hasta registrar en el ERP.", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-19", "valor_agregado": "N/A"}, {"codigo": "SI-PR-004", "documento": "Gesti√≥n de Compras", "dueno": "Erick Verbel Facouseh", "detalle": "Se reemplaza el rol \"√°rea encargada\" por \"√°rea solicitante\"", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-29", "valor_agregado": "12.50%"}, {"codigo": "SI-PR-006", "documento": "Selecci√≥n y creaci√≥n de terceros", "dueno": "Erick Verbel Facouseh", "detalle": "Se reemplaza el rol \"√°rea encargada\" por \"√°rea solicitante\"", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-29", "valor_agregado": "38.46%"}, {"codigo": "SI-PR-008", "documento": "Recolecci√≥n de activos fijos e implementos de trabajo en offboarding", "dueno": "Lina Meza", "detalle": "Ajuste general en las actividades del proceso", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "33.33%"}, {"codigo": "LC-MA-006", "documento": "Manual Ejecuci√≥n Debida Diligencia Intensificada (DDI) CF", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "LC-MA-007", "documento": "Manual Metodol√≥gico Matriz de Riesgos SARLAFT", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "LC-MA-009", "documento": "Manual Metodolog√≠a Segmentaci√≥n de Riesgo Clientes", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "CF", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "SI-PO-002", "documento": "Pol√≠tica activos fijos y elementos de trabajo", "dueno": "Lina Meza", "detalle": "Se a√±ade pol√≠tica de cobertura para equipos en caso de accidentes de tr√°nsito ocurridos en horario laboral.\nSe especifica el procedimiento a seguir y los soportes a presentar en caso de robo de equipos.", "compania": "CF", "tipo": "Actualizaci√≥n", "fecha": "2025-08-08", "valor_agregado": "N/A"}, {"codigo": "OP-PR-169", "documento": "Cierre diario de turno para clientes master merchant SAS", "dueno": "Juan Camilo Salgado Mar√≠n", "detalle": "Su objetivo es garantizar el env√≠o oportuno y seguro del archivo diario de transacciones a comercios master merchant, consolidando la informaci√≥n correspondiente al cierre del turno, y asegurando que nuevos clientes reciban correctamente las instrucciones para el acceso al archivo.", "compania": "SAS", "tipo": "Creaci√≥n", "fecha": "2025-08-04", "valor_agregado": "16.67%"}, {"codigo": "GM-PR-101", "documento": "Comunicaciones a clientes SAS", "dueno": "Jacob Abadia Garcia", "detalle": "Se a√±ade actividad 21. \"Notificar los resultados de la campa√±a\"", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-20", "valor_agregado": "77.27%"}, {"codigo": "TH-PR-108", "documento": "Offboarding de personal", "dueno": "Maria Fernanda Navia Rey", "detalle": "Se eliminan las actividades correspondientes al rol Inventory Analyst\nSe incluye la participaci√≥n del Sales Ops Analyst\nAjuste general del flujo", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-04", "valor_agregado": "45.45%"}, {"codigo": "TH-PR-111", "documento": "Gesti√≥n programa ESOP", "dueno": "Maria Fernanda Navia Rey", "detalle": "Eliminaci√≥n de Carta como gestor de plan de acciones, ahora todo se visualiza en BambooHR y se gestionan con un m√≥dulo de Appian.\nCambio del nombre del proceso.", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-04", "valor_agregado": "93.10%"}, {"codigo": "TH-PR-112", "documento": "Liquidaci√≥n y pago de aportes", "dueno": "Maria Fernanda Navia Rey", "detalle": "Adici√≥n de la actividad 6. \"Conciliar planilla vs. Contabilidad\"", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-04", "valor_agregado": "45.45%"}, {"codigo": "TH-PR-124", "documento": "Cambio interno de rol SAS", "dueno": "Maria Fernanda Navia Rey", "detalle": "Ajuste del proceso", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-11", "valor_agregado": "45.16%"}, {"codigo": "SI-PR-108", "documento": "Recolecci√≥n de activos fijos e implementos de trabajo en offboarding SAS", "dueno": "Maria Fernanda Navia Rey", "detalle": "Inclusi√≥n actividades de recolecci√≥n de activos fijos de manera presencial, y actividades de recolecci√≥n de activos fijos a domicilio.", "compania": "SAS", "tipo": "Actualizaci√≥n", "fecha": "2025-08-04", "valor_agregado": "52.17%"}, {"codigo": "LC-MA-106", "documento": "Manual Ejecuci√≥n Debida Diligencia Intensificada (DDI) SAS", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "SAS", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "LC-MA-107", "documento": "Documento Metodol√≥gico Matriz de Riesgos SAGRILAFT SAS", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "SAS", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "LC-MA-108", "documento": "Documento Metodol√≥gico Matriz de Riesgos PTEE (C/ST) - Programa de Transparencia y √âtica Empresarial SAS", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "SAS", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}, {"codigo": "LC-MA-109", "documento": "Manual Metodolog√≠a Segmentaci√≥n de Riesgo Clientes SAS", "dueno": "Vanessa Fajardo", "detalle": "Creaci√≥n del documento", "compania": "SAS", "tipo": "Creaci√≥n", "fecha": "2025-08-29", "valor_agregado": "N/A"}];

  const cardsEl = document.getElementById('cards');
  let query = '', company = '', sortMode='fecha';
  const pctColor = (p)=> p>=100?'bg-emerald-500':p>=80?'bg-green-500':p>=50?'bg-amber-500':'bg-slate-300';
  const status = (p)=> p>=100?['¬°Listo!','bg-emerald-600 text-white']:p>=80?['Casi','bg-green-600 text-white']:['En curso','bg-slate-200 text-slate-800'];

  function renderCompanies(){ 
    const set=[...new Set(rows.map(r=>r.compania))]; 
    const wrap=document.getElementById('companyBadges'); 
    wrap.innerHTML=''; 
    set.forEach(c=>{ 
      const b=document.createElement('button'); 
      b.className='company-btn bg-white border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 rounded-full px-4 py-2 text-sm font-medium transition-all'; 
      b.textContent=c; 
      b.dataset.company=c; 
      wrap.appendChild(b);
    });
  }
  function renderAuto(){ 
    const list = rows.filter(r => !company || r.compania === company)
                    .filter(r => (r.aplicativo + ' ' + r.aplicacion + ' ' + r.proceso + ' ' + r.detalle + ' ' + r.compania).toLowerCase().includes(query.toLowerCase()))
                    .sort((a,b) => sortMode === 'fecha' ? (parseLocalDate(b.fecha) - parseLocalDate(a.fecha)) : (Number(b.vaFinal) - Number(a.vaFinal)));
    
    cardsEl.innerHTML = ''; 
    
    list.forEach(r => {
      const card = document.createElement('div');
      card.className = 'fade-in rounded-3xl card-shadow bg-white transition-all duration-300';
      
      // Procesar los procesos para mostrarlos como lista con vi√±etas
      let procesosHtml = '';
      if (r.proceso) {
        const procesos = r.proceso.split('\n').filter(p => p.trim());
        if (procesos.length > 1) {
          procesosHtml = '<div class="text-sm font-medium text-slate-700 mb-2">Procesos involucrados:</div><ul class="text-sm text-slate-600 space-y-1 ml-2">';
          procesos.forEach(proceso => {
            procesosHtml += `<li class="flex items-start"><span class="text-indigo-500 mr-2 mt-0.5">‚Ä¢</span><span>${proceso.trim()}</span></li>`;
          });
          procesosHtml += '</ul>';
        } else {
          procesosHtml = `<div class="text-sm font-medium text-slate-700 mb-1">Procesos involucrados:</div><div class="text-sm text-slate-600">${procesos[0]}</div>`;
        }
      }
      
      // Procesar detalle (manejar NaN)
      const detalleText = (r.detalle && !isNaN(r.detalle) === false) ? r.detalle : (r.detalle || 'Sin detalles espec√≠ficos');
      
      card.innerHTML = `
        <div class="h-full flex flex-col">
          <!-- Header con imagen/icono estilo Bold.co -->
          <div class="bg-gradient-to-br from-slate-50 to-gray-100 p-6 rounded-t-3xl">
            <div class="flex items-center justify-between mb-4">
              <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center card-shadow">
                <div class="w-6 h-6 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg"></div>
              </div>
            </div>
            
            <!-- T√≠tulo y aplicativo -->
            <h3 class="font-bold text-lg text-gray-900 mb-2 leading-tight">${r.aplicacion || ''}</h3>
            <div class="flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-white rounded-md text-gray-600 border border-gray-200">${r.aplicativo || ''}</span>
              <span class="text-xs px-2 py-1 bg-gray-900 text-white rounded-md">${r.compania || ''}</span>
            </div>
          </div>
          
          <!-- Contenido principal -->
          <div class="flex-1 p-6 space-y-4">
            <!-- Procesos involucrados -->
            <div>
              ${procesosHtml}
            </div>
            
            <!-- Detalle (limitado para mantener tarjetas uniformes) -->
            <div class="bg-gray-50 p-4 rounded-xl">
              <div class="text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide">Detalle</div>
              <p class="text-sm text-gray-700 line-clamp-3">${detalleText}</p>
            </div>
            
            <!-- M√©tricas estilo Bold.co -->
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl">
              <div class="grid grid-cols-3 gap-4 text-center">
                <div>
                  <div class="text-xs text-gray-500 font-medium mb-1">VA Inicial</div>
                  <div class="font-bold text-lg text-gray-700">${Math.max(0, Number(r.vaFinal) - Number(r.incrementoVA))}%</div>
                </div>
                <div>
                  <div class="text-xs text-gray-500 font-medium mb-1">Incremento</div>
                  <div class="font-bold text-lg text-emerald-600">+${Number(r.incrementoVA)}%</div>
                </div>
                <div>
                  <div class="text-xs text-gray-500 font-medium mb-1">VA Final</div>
                  <div class="font-bold text-xl bold-primary">${Number(r.vaFinal)}%</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Footer con fecha -->
          <div class="px-6 pb-6">
            <div class="text-xs text-gray-500 flex items-center justify-center gap-2 py-3 bg-gray-50 rounded-xl">
              üìÖ Fecha en prod: <span class="font-semibold text-gray-700">${formatDate(r.fecha)}</span>
            </div>
          </div>
        </div>
      `;
      
      cardsEl.appendChild(card);
    });
    
    // Actualizar filtros de compa√±√≠a
    document.querySelectorAll('.company-btn').forEach(btn => {
      if ((btn.dataset.company || '') === company) {
        btn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-700');
        btn.classList.remove('border-gray-200', 'bg-white');
      } else {
        btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-700');
        btn.classList.add('border-gray-200', 'bg-white');
      }
    });
  }
  document.getElementById('q').addEventListener('input',(e)=>{query=e.target.value;renderAuto();});
  document.getElementById('sortBtn').addEventListener('click',()=>{
    sortMode=sortMode==='fecha'?'va':'fecha';
    document.getElementById('sortBtn').innerHTML = sortMode==='fecha'?'üìà Ordenar por % VA':'üìÖ Ordenar por Fecha';
    renderAuto();
  });
  document.getElementById('resetBtn').addEventListener('click',()=>{
    query='';
    company='';
    sortMode='fecha';
    document.getElementById('q').value='';
    document.getElementById('sortBtn').innerHTML='üìà Ordenar por % VA';
    renderAuto();
  });
  document.addEventListener('click',(e)=>{const b=e.target.closest('.company-btn');if(b){company=b.dataset.company||'';renderAuto();}});

  // ======== CAMBIOS ‚Äî listado con paginaci√≥n ========
  const tbodyCambios=document.getElementById('tbodyCambios');
  const countCambios=document.getElementById('countCambios');
  const pageInfo=document.getElementById('pageInfo');
  const prevBtn=document.getElementById('prevPage');
  const nextBtn=document.getElementById('nextPage');
  let q2 = '', sort2 = 'fecha', page = 1, pageSize = 10;
  let columnFilters = {}; // Objeto para guardar filtros por columna
  let currentFilterColumn = '';
  
  // Funci√≥n para mostrar dropdown de filtro
  window.showFilterDropdown = function(column, event) {
    event.stopPropagation();
    currentFilterColumn = column;
    
    const dropdown = document.getElementById('filterDropdown');
    const rect = event.target.getBoundingClientRect();
    
    // Posicionar dropdown
    dropdown.style.left = Math.min(rect.left, window.innerWidth - 280) + 'px';
    dropdown.style.top = (rect.bottom + 5) + 'px';
    
    // Poblar opciones de filtro para la columna
    populateFilterOptions(column);
    
    dropdown.classList.remove('hidden');
    
    // Cerrar dropdown al hacer click fuera
    setTimeout(() => {
      document.addEventListener('click', hideFilterDropdownOutside);
    }, 100);
  }
  
  // Funci√≥n para ocultar dropdown
  window.hideFilterDropdown = function() {
    const dropdown = document.getElementById('filterDropdown');
    dropdown.classList.add('hidden');
    document.removeEventListener('click', hideFilterDropdownOutside);
  }
  
  function hideFilterDropdownOutside(event) {
    const dropdown = document.getElementById('filterDropdown');
    if (!dropdown.contains(event.target)) {
      hideFilterDropdown();
    }
  }
  
  // Funci√≥n para poblar las opciones de filtro de una columna
  function populateFilterOptions(column) {
    const filterOptions = document.getElementById('filterOptions');
    const columnSearch = document.getElementById('columnSearch');
    
    // Obtener valores √∫nicos de la columna
    let values = [];
    cambios.forEach(row => {
      let value = '';
      switch(column) {
        case 'codigo': value = row.codigo || ''; break;
        case 'documento': value = row.documento || ''; break;
        case 'dueno': value = row.dueno || ''; break;
        case 'detalle': value = row.detalle || ''; break;
        case 'compania': value = row.compania || ''; break;
        case 'tipo': value = row.tipo || ''; break;
        case 'fecha': value = formatDate(row.fecha) || ''; break;
        case 'va': value = row.valor_agregado || 'N/A'; break;
      }
      if (value && !values.includes(value)) {
        values.push(value);
      }
    });
    
    values.sort();
    
    // Limpiar opciones anteriores
    filterOptions.innerHTML = '';
    columnSearch.value = '';
    
    // Crear checkboxes para cada valor
    const currentFilters = columnFilters[column] || [];
    const allSelected = currentFilters.length === 0;
    
    values.forEach(value => {
      const isSelected = allSelected || currentFilters.includes(value);
      
      const label = document.createElement('label');
      label.className = 'flex items-center gap-2 px-2 py-1 hover:bg-gray-50 text-sm filter-option';
      label.innerHTML = `
        <input type="checkbox" value="${value}" ${isSelected ? 'checked' : ''} onchange="updateSelectAll()">
        <span>${value}</span>
      `;
      filterOptions.appendChild(label);
    });
    
    // Actualizar estado del "Seleccionar todo"
    document.getElementById('selectAll').checked = allSelected;
    
    // Event listener para b√∫squeda dentro de la columna
    columnSearch.oninput = function() {
      const searchTerm = this.value.toLowerCase();
      const options = filterOptions.querySelectorAll('.filter-option');
      options.forEach(option => {
        const text = option.textContent.toLowerCase();
        option.style.display = text.includes(searchTerm) ? 'flex' : 'none';
      });
    };
  }
  
  // Funci√≥n para toggle de "Seleccionar todo"
  window.toggleAllFilters = function() {
    const selectAll = document.getElementById('selectAll');
    const checkboxes = document.querySelectorAll('#filterOptions input[type="checkbox"]');
    
    checkboxes.forEach(checkbox => {
      if (checkbox.closest('.filter-option').style.display !== 'none') {
        checkbox.checked = selectAll.checked;
      }
    });
  }
  
  // Funci√≥n para actualizar estado del "Seleccionar todo"
  window.updateSelectAll = function() {
    const checkboxes = Array.from(document.querySelectorAll('#filterOptions input[type="checkbox"]'));
    const visibleCheckboxes = checkboxes.filter(cb => cb.closest('.filter-option').style.display !== 'none');
    const checkedBoxes = visibleCheckboxes.filter(cb => cb.checked);
    
    const selectAll = document.getElementById('selectAll');
    selectAll.checked = checkedBoxes.length === visibleCheckboxes.length;
    selectAll.indeterminate = checkedBoxes.length > 0 && checkedBoxes.length < visibleCheckboxes.length;
  }
  
  // Funci√≥n para aplicar ordenamiento desde el dropdown
  window.applySortFilter = function(direction) {
    sort2 = currentFilterColumn + (direction === 'asc' ? '-asc' : '');
    page = 1;
    renderCambios();
    hideFilterDropdown();
  }
  
  // Funci√≥n para aplicar filtros de columna
  window.applyColumnFilter = function() {
    const checkboxes = document.querySelectorAll('#filterOptions input[type="checkbox"]:checked');
    const selectedValues = Array.from(checkboxes).map(cb => cb.value);
    
    if (selectedValues.length === document.querySelectorAll('#filterOptions input[type="checkbox"]').length) {
      // Si todos est√°n seleccionados, no aplicar filtro
      delete columnFilters[currentFilterColumn];
    } else {
      // Aplicar filtro con valores seleccionados
      columnFilters[currentFilterColumn] = selectedValues;
    }
    
    page = 1;
    renderCambios();
    hideFilterDropdown();
  }
  
  // Funci√≥n para limpiar filtro de la columna actual
  window.clearColumnFilter = function() {
    delete columnFilters[currentFilterColumn];
    page = 1;
    renderCambios();
    hideFilterDropdown();
  }
  
 function rowCambios(r){
    const tipoClass = r.tipo === 'Creaci√≥n'
      ? 'bg-indigo-50 text-indigo-700 border border-indigo-200'
      : 'bg-amber-50 text-amber-700 border border-amber-200';
    const va = (!r.valor_agregado || String(r.valor_agregado).trim() === '' || String(r.valor_agregado).toUpperCase() === 'N/A')
      ? 'No aplica'
      : r.valor_agregado;
    
    // Verificar si existe un enlace para el documento
    const documentoNombre = r.documento || '';
    const documentoLink = documentLinks[documentoNombre];
    const documentoHTML = documentoLink 
      ? `<a href="${documentoLink}" target="_blank" rel="noopener noreferrer" class="text-bold-primary hover:underline font-medium">${documentoNombre}</a>`
      : documentoNombre;

    return `
      <tr class="border-b border-slate-100 hover:bg-slate-50">
        <td class="px-3 py-2 font-medium text-slate-800 w-32">${r.codigo}</td>
        <td class="px-3 py-2">${documentoHTML}</td>
        <td class="px-3 py-2 w-48 text-sm" title="${r.dueno || ''}">${r.dueno || ''}</td>
        <td class="px-3 py-2 text-slate-700">${r.detalle || ''}</td>
        <td class="px-3 py-2 w-20 text-center">${r.compania || ''}</td>
        <td class="px-3 py-2 w-24">
          <span class="text-xs px-2 py-1 rounded-full ${tipoClass}">${r.tipo}</span>
        </td>
        <td class="px-3 py-2 w-28 text-center">${formatDate(r.fecha)}</td>
        <td class="px-3 py-2 w-20 text-center">${va}</td>
      </tr>
    `;
  }
  function getFilteredCambios(){ 
    return cambios
      .filter(r => {
        // Filtro de b√∫squeda global
        if (q2) {
          const searchStr = (r.codigo + ' ' + r.documento + ' ' + (r.dueno || '') + ' ' + (r.detalle || '') + ' ' + (r.compania || '') + ' ' + (r.valor_agregado || '')).toLowerCase();
          if (!searchStr.includes(q2.toLowerCase())) return false;
        }
        
        // Filtros por columna
        for (const [column, filters] of Object.entries(columnFilters)) {
          if (filters && filters.length > 0) {
            let value = '';
            switch(column) {
              case 'codigo': value = r.codigo || ''; break;
              case 'documento': value = r.documento || ''; break;
              case 'dueno': value = r.dueno || ''; break;
              case 'detalle': value = r.detalle || ''; break;
              case 'compania': value = r.compania || ''; break;
              case 'tipo': value = r.tipo || ''; break;
              case 'fecha': value = formatDate(r.fecha) || ''; break;
              case 'va': value = r.valor_agregado || 'N/A'; break;
            }
            if (!filters.includes(value)) return false;
          }
        }
        
        return true;
      })
      .sort((a, b) => {
        if (sort2 === 'fecha') return parseLocalDate(b.fecha) - parseLocalDate(a.fecha);
        if (sort2 === 'fecha-asc') return parseLocalDate(a.fecha) - parseLocalDate(b.fecha);
        if (sort2 === 'codigo') return (b.codigo || '').localeCompare(a.codigo || '');
        if (sort2 === 'codigo-asc') return (a.codigo || '').localeCompare(b.codigo || '');
        if (sort2 === 'documento') return (b.documento || '').localeCompare(a.documento || '');
        if (sort2 === 'documento-asc') return (a.documento || '').localeCompare(b.documento || '');
        if (sort2 === 'dueno') return (b.dueno || '').localeCompare(a.dueno || '');
        if (sort2 === 'dueno-asc') return (a.dueno || '').localeCompare(b.dueno || '');
        if (sort2 === 'compania') return (b.compania || '').localeCompare(a.compania || '');
        if (sort2 === 'compania-asc') return (a.compania || '').localeCompare(b.compania || '');
        if (sort2 === 'tipo') return (b.tipo || '').localeCompare(a.tipo || '');
        if (sort2 === 'tipo-asc') return (a.tipo || '').localeCompare(b.tipo || '');
        if (sort2 === 'va') {
          const aVal = parseFloat(String(a.valor_agregado).replace('%', '')) || 0;
          const bVal = parseFloat(String(b.valor_agregado).replace('%', '')) || 0;
          return bVal - aVal;
        }
        if (sort2 === 'va-asc') {
          const aVal = parseFloat(String(a.valor_agregado).replace('%', '')) || 0;
          const bVal = parseFloat(String(b.valor_agregado).replace('%', '')) || 0;
          return aVal - bVal;
        }
        return 0;
      }); 
  }
  function renderCambios(){ 
    const all = getFilteredCambios(); 
    const totalPages = Math.max(1, Math.ceil(all.length / pageSize)); 
    if (page > totalPages) page = totalPages; 
    const start = (page - 1) * pageSize; 
    const list = all.slice(start, start + pageSize); 
    
    tbodyCambios.innerHTML = list.map(rowCambios).join(''); 
    countCambios.textContent = all.length + ' resultado' + (all.length !== 1 ? 's' : ''); 
    pageInfo.textContent = page + ' / ' + totalPages; 
    prevBtn.disabled = page <= 1; 
    nextBtn.disabled = page >= totalPages;
    
    updateFilterIndicators();
  }
  
  // Funci√≥n para actualizar indicadores visuales de filtros activos
  function updateFilterIndicators() {
    document.querySelectorAll('.filter-btn').forEach(btn => {
      const column = btn.dataset.column;
      if (columnFilters[column] && columnFilters[column].length > 0) {
        btn.style.color = '#3b82f6'; // azul para indicar filtro activo
      } else {
        btn.style.color = ''; // color por defecto
      }
    });
  }
  document.getElementById('q2').addEventListener('input', (e) => { 
    q2 = e.target.value; 
    page = 1; 
    renderCambios(); 
  });
    
  document.getElementById('resetBtn2').addEventListener('click', () => {
    q2 = '';
    columnFilters = {};
    sort2 = 'fecha';
    page = 1;
    
    document.getElementById('q2').value = '';
    
    renderCambios();
  });
  prevBtn.addEventListener('click',()=>{if(page>1){page--;renderCambios();}});
  nextBtn.addEventListener('click',()=>{page++;renderCambios();});

  // ======== NAVEGACI√ìN STICKY TRANSFORMADA ========
  const stickyNav = document.getElementById('stickyNav');
  const heroNavButtons = document.getElementById('heroNavButtons');
  const sections = document.querySelectorAll('section[id]');
  const stickyNavBtns = document.querySelectorAll('.sticky-nav-btn');
  const heroNavBtns = document.querySelectorAll('.hero-nav-btn');
  
  // Funci√≥n para mostrar/ocultar navegaci√≥n sticky
  function toggleStickyNav() {
    const heroRect = heroNavButtons.getBoundingClientRect();
    const shouldShow = heroRect.bottom < 0; // Hero nav ya no es visible
    
    if (shouldShow) {
      stickyNav.classList.remove('translate-y-[-100%]', 'opacity-0');
      stickyNav.classList.add('translate-y-0', 'opacity-100');
    } else {
      stickyNav.classList.add('translate-y-[-100%]', 'opacity-0');
      stickyNav.classList.remove('translate-y-0', 'opacity-100');
    }
  }
  
  // Funci√≥n para actualizar bot√≥n activo basado en posici√≥n de scroll
  function updateActiveNavButton() {
    let current = '';
    sections.forEach(section => {
      const sectionTop = section.getBoundingClientRect().top;
      if (sectionTop <= 200) { // offset para detecci√≥n de secci√≥n
        current = section.getAttribute('id');
      }
    });
    
    // Actualizar botones del hero
    heroNavBtns.forEach(btn => {
      const href = btn.getAttribute('href');
      if (href === `#${current}`) {
        btn.style.transform = 'scale(1.05)';
        btn.style.boxShadow = '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)';
      } else {
        btn.style.transform = 'scale(1)';
        btn.style.boxShadow = '0 25px 50px -12px rgba(0, 0, 0, 0.25)';
      }
    });
    
    // Actualizar botones sticky
    stickyNavBtns.forEach(btn => {
      const href = btn.getAttribute('href');
      if (href === `#${current}`) {
        btn.style.transform = 'scale(1.1)';
        btn.style.boxShadow = '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)';
      } else {
        btn.style.transform = 'scale(1)';
        btn.style.boxShadow = '';
      }
    });
  }
  
  // ======== BOT√ìN VOLVER ARRIBA ========
  function scrollToTop() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  }
  
  // Mostrar/ocultar bot√≥n flotante
  const scrollToTopFloat = document.getElementById('scrollToTopFloat');
  function toggleScrollButton() {
    if (window.pageYOffset > 300) {
      scrollToTopFloat.classList.remove('opacity-0', 'pointer-events-none');
      scrollToTopFloat.classList.add('opacity-100', 'pointer-events-auto');
    } else {
      scrollToTopFloat.classList.add('opacity-0', 'pointer-events-none');
      scrollToTopFloat.classList.remove('opacity-100', 'pointer-events-auto');
    }
  }
  
  // Escuchar scroll para navegaci√≥n activa, sticky nav y bot√≥n flotante
  window.addEventListener('scroll', () => {
    toggleStickyNav();
    updateActiveNavButton();
    toggleScrollButton();
  });
  
  // ======== INICIALIZACI√ìN ========
  renderCompanies();
  renderAuto();
  renderCambios();
  toggleStickyNav();
  updateActiveNavButton();

  // ======== VA por Unidad de Negocio: im√°genes fijas + lightbox ========
  const img1 = document.getElementById('img1');
  const img2 = document.getElementById('img2');

// === Drive helpers con Fallback ===
// Extrae el FILE_ID del link de compartir (termina en /view)
function extractDriveId(link){
  const m = link.match(/\/d\/([a-zA-Z0-9_-]+)/) || link.match(/[?&]id=([^&]+)/);
  return m ? m[1] : null;
}

// Intenta varios endpoints de Drive hasta que uno funcione
function setDriveImage(imgEl, shareLink){
  const id = extractDriveId(shareLink);
  if(!id){ console.warn('No se pudo extraer FILE_ID de:', shareLink); return; }

  // Orden de prueba (el 3 y 4 suelen ser los m√°s robustos)
  const candidates = [
    `https://drive.google.com/uc?export=view&id=${id}`,
    `https://drive.google.com/uc?export=download&id=${id}`,
    `https://lh3.googleusercontent.com/d/${id}=s2000`,            // proxy de googleusercontent
    `https://drive.google.com/thumbnail?id=${id}&sz=w10000`      // thumbnail tama√±o grande
  ];

  let idx = 0;
  function tryNext(){
    if(idx >= candidates.length){
      console.error('Ninguna URL de Drive funcion√≥ para', shareLink);
      return;
    }
    const url = candidates[idx++];
    // asigna y, si hay error, intenta la siguiente
    imgEl.onerror = () => tryNext();
    imgEl.src = url;
    console.log('Probando URL Drive =>', url);
  }
  tryNext();
}
// Pega tus links de "Obtener v√≠nculo" (los que terminan en /view)
setDriveImage(img1, "https://drive.google.com/file/d/1ZbS5WyojhMcdcZz5TINSL2yGTxwQbskb/view"); // SAS
setDriveImage(img2, "https://drive.google.com/file/d/1fUxaxuNvT5EdzAai_NvUL773Qq_mjk2O/view"); // CF

// (temporal) para depurar, ver la URL final en consola
console.log('img1 URL =>', img1.src);
console.log('img2 URL =>', img2.src);

  // Lightbox (zoom)
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightboxImg');

  function openLightbox(src){
    if(!src) return;
    lightboxImg.src = src;
    lightbox.classList.remove('hidden');
    lightbox.classList.add('flex');
  }
  function closeLightbox(){
    lightbox.classList.add('hidden');
    lightbox.classList.remove('flex');
    lightboxImg.src = '';
  }

  img1?.addEventListener('click', ()=> openLightbox(img1.src));
  img2?.addEventListener('click', ()=> openLightbox(img2.src));
  lightbox?.addEventListener('click', closeLightbox);
  document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeLightbox(); });

</script>
</body>
</html>
